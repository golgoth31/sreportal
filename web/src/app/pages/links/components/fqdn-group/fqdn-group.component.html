<mat-expansion-panel [expanded]="true">
  <mat-expansion-panel-header>
    <mat-panel-title>
      <mat-icon class="source-icon">{{ sourceIcon() }}</mat-icon>
      {{ group().name }}
    </mat-panel-title>
    <mat-panel-description>
      <mat-chip>{{ sourceLabel() }}</mat-chip>
      <span class="fqdn-count">{{ group().fqdns.length }} entries</span>
    </mat-panel-description>
  </mat-expansion-panel-header>

  <div class="fqdn-grid">
    @for (fqdn of group().fqdns; track fqdn.name) {
      <mat-card appearance="outlined" class="fqdn-card">
        <mat-card-content>
          <div class="fqdn-card__main">
            @if (fqdn.syncStatus) {
              <span class="sync-dot"
                    [class.sync-dot--ok]="fqdn.syncStatus === 'sync'"
                    [class.sync-dot--ko]="fqdn.syncStatus !== 'sync'"
                    [matTooltip]="syncStatusLabel(fqdn.syncStatus)">
                <span class="sr-only">{{ syncStatusLabel(fqdn.syncStatus) }}</span>
              </span>
            }
            <a [href]="'https://' + fqdn.name"
               target="_blank"
               rel="noopener noreferrer"
               class="fqdn-card__name mono">
              {{ fqdn.name }}
            </a>
            <button mat-icon-button
                    (click)="copyToClipboard(fqdn.name)"
                    [matTooltip]="copiedFqdn() === fqdn.name ? 'Copied!' : 'Copy ' + fqdn.name"
                    [attr.aria-label]="copiedFqdn() === fqdn.name ? 'Copied' : 'Copy ' + fqdn.name">
              <mat-icon>{{ copiedFqdn() === fqdn.name ? 'check' : 'content_copy' }}</mat-icon>
            </button>
          </div>

          @if (fqdn.description) {
            <p class="fqdn-card__description">{{ fqdn.description }}</p>
          }

          <div class="fqdn-card__meta">
            @if (fqdn.recordType) {
              <mat-chip>{{ fqdn.recordType }}</mat-chip>
            }
            @if (fqdn.targets.length > 0) {
              <span class="fqdn-card__targets mono">{{ fqdn.targets.join(', ') }}</span>
            }
            <mat-chip [highlighted]="true">{{ fqdn.source }}</mat-chip>
          </div>

          @if (fqdn.originRef) {
            <div class="fqdn-card__origin">
              <mat-icon class="fqdn-card__origin-icon"
                        matTooltip="Origin Kubernetes resource">device_hub</mat-icon>
              <span class="mono">{{ fqdn.originRef.kind }}/{{ fqdn.originRef.namespace }}/{{ fqdn.originRef.name }}</span>
            </div>
          }
        </mat-card-content>
      </mat-card>
    }
  </div>
</mat-expansion-panel>
